import os
import pandas as pd
from dotenv import load_dotenv
import db_operations
import yake
import spacy
import numpy as np

#%% Dotenv permette di recuperare le variabili d'ambiente da un file .env
load_dotenv("../.env")

INPUT_DB_HOST = os.getenv("INPUT_DB_HOST")
INPUT_DB_NAME = os.getenv("INPUT_DB_NAME")
INPUT_DB_USER = os.getenv("INPUT_DB_USER")
INPUT_DB_PASSWORD = os.getenv("INPUT_DB_PASSWORD")
INPUT_DB_PORT = int(os.getenv("INPUT_DB_PORT"))

OUTPUT_DB_HOST = os.getenv("OUTPUT_DB_HOST")
OUTPUT_DB_NAME = os.getenv("OUTPUT_DB_NAME")
OUTPUT_DB_USER = os.getenv("OUTPUT_DB_USER")
OUTPUT_DB_PASSWORD = os.getenv("OUTPUT_DB_PASSWORD")
OUTPUT_DB_PORT = int(os.getenv("OUTPUT_DB_PORT"))

create_table_eurostat_query = """CREATE TABLE IF NOT EXISTS eurostat (
                            id INT PRIMARY KEY,
                            argomento TEXT NOT NULL,
                            descrizione TEXT NOT NULL)""" 
                            
db_operations.table_operation(INPUT_DB_HOST, INPUT_DB_NAME, INPUT_DB_USER, INPUT_DB_PASSWORD, INPUT_DB_PORT, create_table_eurostat_query)

dati_eurostat = [
    (1, "Employment in sport (sprt_emp)", "Statistics on employment in sport are derived from data collected by the European Labour Force Survey (EU-LFS). These statistics aim to investigate the contribution of sport employment to overall employment and track the number of jobs in sport over time. The EU-LFS is the primary source of information on the labour market situation and trends within the European Union. The methodology for designing and developing statistics on employment in sport is based on the framework outlined in the final report of the European Statistical System Network on Culture (ESS-net Culture final report 2012). This methodology takes into account two reference classifications: the NACE classification, which classifies economic activities, and the ISCO classification, which classifies occupations. Results from the EU-LFS allow the characterization of employment in sport by various variables such as gender, age, and educational attainment, by cross-tabulating the ISCO and NACE selected sport codes. Since 1 January 2021, the EU-LFS operates under Regulation (EU) 2019/1700, known as the Integrated European Social Statistics Framework Regulation (IESS FR), and its Commission Implementing Regulation (EU) 2019/2240. For more detailed information, the EU-LFS metadata can be consulted."),
    (2, "Air transport infrastructure (avia_if)", "The Questionnaire on Air Transport Statistics is designed to collect aggregated annual data on the air transport sector, focusing on two main areas: Infrastructure and Enterprises, Economic Performance, and Employment, with data being collected at both country level and, for major European airports, at the airport level. The infrastructure section covers only commercial airports and reports data as of December 31st each year. It includes three key tables: the first one provides the number of commercial airports, categorized by main airports (with more than 150,000 passenger units per year), other airports (between 15,000 and 150,000 passenger units per year), and small airports (below 15,000 passenger units per year) at the country level. The second table presents data on airport infrastructures by type, focusing only on main airports. The third table covers airport connections to other modes of transport and is limited to main airports, with updates since the 2013 reference year focusing on intermodal storage areas in square meters. The data for the infrastructure section are partially derived from regulatory data collection, notably Regulation 473/2003, and include information about small airports only if provided by a country, as these airports are not required to submit regulatory data. For the aircraft fleet data, these are collected through a separate official source (Cirium database), and these data are no longer included in the prefilled questionnaires for validation purposes. The 'Air Transport Equipment' section contains four tables detailing the commercial aircraft fleet. These tables provide insights into the fleet by aircraft category and age, at both the country of operator and country of registration levels. The 'Enterprises, Economic Performance, and Employment' section includes three tables. However, due to a low response rate, two tables—those on the number of aviation and airport enterprises and on employment in aviation and airport enterprises by sex—are no longer updated, with the latest data from 2013. The remaining table covers employment in main airports by sex, though it only provides total employment data. It is important to note that the data collection is not supported by legal acts but instead follows a gentlemen's agreement with participating countries, including Member States, Iceland, Norway, Switzerland, Turkey, the UK (until the 2018 reference year), North Macedonia, Serbia, and Montenegro. The data's completeness varies across countries due to the voluntary nature of the data collection. For further information, data related to the Air Transport Statistics Regulation can be found in the metadata documentation for the Air Transport Measurement domain."),
    (3, "Forest resources and environmental functions", "This metadata file pertains to data on forest resources from several sources. These include the European Forest Accounts (EFA), the FAO Forest Resources Assessment (FAO - FRA), and the Forest Europe - State of Europe's Forests report. The EFA is Eurostat's annual data collection focusing on forest resources and the economic activities related to the forestry and logging industry. The FAO FRA provides data every five years, as does the Forest Europe report on the state of Europe's forests. The data covered in this metadata file is published in Eurostat’s public database in several tables. For wooded land area, data is available from the EFA in the table titled 'for_area_efa' and from the FAO FRA in the table 'for_area.' Regarding the value of wooded land, this is also reported by the EFA in the table 'for_area_efa.' For timber volume, the EFA provides data in the 'for_vol_efa' table, which has been supplemented with modelled data from the Carbon Budget Model and official statistics reported to FAO and Eurostat. The corresponding table from the FAO FRA is titled 'for_vol.' The value of timber is included in the 'for_vol_efa' table from the EFA. In terms of the protective functions of forests, data is provided by Forest Europe in the table 'for_profnc,' while information on protected forests is available from the same source in the table 'for_protect.' The EFA questionnaire, along with its explanatory notes, can be found in the methodological section under environmental statistics and accounts, specifically under the 'Forest accounts' dropdown menu. The EFA covers more than just forest area and timber volume; it also includes economic data related to forestry and logging, output by type of forestry industry, physical and monetary data on the supply and use of wood, and employment data. These are further elaborated in the metadata file for Economic aggregates of forestry."),
    (4, "ICT sector (isoc_se)", "For over two decades, the ICT sector has been at the core of economic transformation, driving competitiveness in the knowledge economy, attracting investment, and fostering innovation. By generating new technologies applicable across multiple industries, it plays a strategic role in promoting growth, innovation, and efficiency throughout European economies. A well-developed ICT sector is essential for capitalizing on digitalization, maintaining competitiveness in global markets, securing Europe’s technological leadership, and ensuring that the digital economy’s growth potential benefits the entire European economy. In recent years, the importance of ICT has been increasingly recognized in EU policy, notably in the European Commission’s strategy A Europe fit for the digital age. This initiative emphasizes Europe’s role in leading the transition to both a more sustainable planet and a digital future. The EU digital strategy, aimed at empowering individuals and businesses with next-generation technologies, aligns with the goal of making Europe climate-neutral by 2050. The strategy is structured around two key objectives: shaping Europe's digital future, ensuring that digital transformation benefits everyone, and Europe's Digital Decade, outlining the vision and pathways for Europe’s digital transformation by 2030. This transformation is symbolized by a digital compass that translates EU digital ambitions into concrete actions. The collection of ICT sector data serves to benchmark and monitor sectoral developments from a policy-driven perspective, providing relevant information to policymakers. It includes five key indicators measuring the sector’s significance, dynamism, and capacity to drive innovation through R&D expenditure and personnel. These indicators cover the ICT sector’s share in gross value added, the proportion of ICT personnel in total employment, the percentage change in value added over consecutive years, business R&D expenditure in ICT as a share of total R&D spending, and the percentage of R&D personnel working in the ICT sector. ICT sector indicators are derived through secondary statistical analysis. While this approach ensures cost-efficiency and high-quality data collection, it also presents certain limitations in designing new indicators and controlling data quality and release timing. The indicators, presented by country and year, are based on data from Structural Business Statistics (SBS), National Accounts (NA), and Research and Development (R&D) statistics within the Eurostat database. Additional links to Business Demography data help provide a broader picture of the ICT sector. All five indicators are updated annually, with data available from 2008 onward for the first three indicators and from 2005 onward for the last two. The most recent data is incorporated as it becomes available from SBS, NA, and R&D statistics. The metadata guidelines for Structural Business Statistics, National Accounts, and R&D Statistics apply to data extracted from these respective primary statistical sources."),
    (5, "High-tech industry and knowledge-intensive services (htec)", "Statistics on high-tech industry and knowledge-intensive services, often referred to as high-tech statistics, encompass economic, employment, and science, technology, and innovation (STI) data. These statistics describe manufacturing and services industries or traded products classified by technological intensity. The domain relies on multiple Eurostat data sources, including CIS, COMEXT, HRST, LFS, PATENT, R&D, and SBS, making its coverage dependent on these primary sources. Three main approaches are used to identify technology intensity: the sectoral approach, the product approach, and a third approach applied to high-tech and biotechnology patents, aggregated according to the International Patent Classification (IPC) 8th edition. The sectoral approach is based on an aggregation of manufacturing industries according to technological intensity, measured by R&D expenditure relative to value added. This classification follows the Statistical Classification of Economic Activities in the European Community (NACE) at the 2-digit level, grouping industries into high-technology, medium high-technology, medium low-technology, and low-technology sectors. Services are categorized as knowledge-intensive services (KIS) or less knowledge-intensive services (LKIS) based on the share of tertiary-educated persons in each sector at the NACE 2-digit level. This approach applies to all indicators except high-tech trade and patents. Due to the revision of NACE from version 1.1 to version 2 in 2008, the classification of high-technology industries and knowledge-intensive services has changed. For high-tech statistics, this means two definitions are used in parallel, with data presented in separate tables according to the relevant NACE version. For instance, Labour Force Survey (LFS) data is available for both NACE versions, and tables are duplicated to show results using NACE Rev. 2 from 2008 onward. More details are provided in Annexes 2 and 3. A second classification within the sectoral approach, Knowledge Intensive Activities (KIA), is based on the share of tertiary-educated workers across all industry and service sectors, including public sector activities, according to NACE at the 2-digit level for all EU Member States. A threshold determines whether a sector qualifies as knowledge-intensive. Unlike the primary sectoral approach, which uses different methodologies for manufacturing and services, the KIA classification applies a single methodology across all sectors. The classifications in use are Total Knowledge Intensive Activities (KIA) and Knowledge Intensive Activities in Business Industries (KIABI), with both definitions following NACE Rev. 1.1 and NACE Rev. 2. As with other high-tech statistics, the transition from NACE Rev. 1.1 to NACE Rev. 2 in 2008 resulted in changes to the classification, with data available in separate tables. More details are in Annexes 7 and 8. The product approach complements the sectoral approach and applies to high-tech trade data. This classification is based on R&D intensity calculations for groups of products, measured as R&D expenditure relative to total sales. Products classified as high-technology are aggregated using the Standard International Trade Classification (SITC). The initial definition, based on SITC Rev. 3, was used for high-tech product aggregates until 2007. With the implementation of SITC Rev. 4 in 2007, the classification was revised, and Eurostat now presents high-tech trade data using this updated classification. More details are available in Annexes 4 and 5. High-tech patents follow a different classification approach, with groups aggregated according to the International Patent Classification (IPC) 8th edition. Biotechnology patents also use this classification system. More details on high-tech and biotechnology patent aggregation can be found in Annex 6. Additionally, the high-tech domain includes the sub-domain of Venture Capital Investments, with data provided by Invest Europe (formerly the European Private Equity and Venture Capital Association, EVCA). Further details on this data source are available in the Eurostat metadata on venture capital investments. For paragraphs where regional metadata is not explicitly specified, it aligns with the metadata provided at the national level."),
    (6, "Occupancy of tourist accommodation establishments (tour_occ)", "This collection focuses on internal tourism, encompassing both domestic tourism, which refers to tourism flows within the country, and inbound tourism, which refers to visits from abroad to destinations within the country. It exclusively includes flows of tourists staying in rented accommodation, with certain limitations in scope, and is therefore also known as 'accommodation statistics.' This segment of tourism statistics is sometimes referred to as 'the supply side.' Accommodation statistics are a fundamental component of the system of tourism statistics in the EU, with a long history of data collection. Annex I of Regulation (EU) 692/2011 of the European Parliament and of the Council governs accommodation statistics and consists of four sections, with sections 1 and 2 specifically outlining the requirements for rented accommodation in terms of capacity and occupancy. The data is collected by the relevant national authorities of Member States, typically the national statistical institute, and compiled following harmonised concepts, definitions, and recommended methodological guidelines before being transmitted to Eurostat. Most countries collect this data through sample or census surveys, sometimes employing automated methods. In some cases, however, the data is compiled from a demand-side perspective, using visitor or border surveys. Surveys on the occupancy of accommodation establishments are usually conducted on a monthly basis. The concepts and definitions applied in this data collection adhere to the specifications detailed in the Methodological Manual for Tourism Statistics. Accommodation statistics include monthly data on tourism industries classified under NACE 55.1, 55.2, and 55.3. They also encompass monthly occupancy data for tourist accommodation establishments, detailing arrivals and nights spent by both residents and non-residents. Since the reference year 2020, monthly data on nights spent is available at the NUTS 2 regional level, transmitted annually by Member States. Additionally, net occupancy rates of bed places and bedrooms in hotels and similar accommodation are recorded. Annual data includes occupancy statistics of tourist accommodation establishments, broken down into arrivals and nights spent by residents and non-residents, as well as capacity statistics, which cover the number of establishments, bedrooms, and bed places. Regional data comprises annual occupancy figures, specifically arrivals and nights spent by residents and non-residents at the NUTS 2 level, further broken down by month. It also includes data at the NUTS 3 level, categorised by degree of urbanisation, coastal or non-coastal areas, and selected cities. Some indicators are available exclusively for nights spent, without data on arrivals. Additionally, annual data on the number of establishments, bedrooms, and bed places is available at the NUTS 2 level, with further classifications based on urbanisation degree and coastal/non-coastal status. Data on establishments, bedrooms, and bed places by activity is available at the NUTS 3 level until 2011. For paragraphs where regional metadata has not been explicitly specified, the regional metadata aligns with the national metadata."),
    (7, "Health variables of EU-SILC", "The European Statistics on Income and Living Conditions (EU-SILC) survey includes a small module on health, consisting of three variables related to health status and four variables on unmet needs for health care. The variables on health status form the Minimum European Health Module (MEHM) and measure three distinct aspects of health: self-perceived health, chronic morbidity, referring to individuals with a long-standing illness or health problem, and activity limitation (disability), representing self-perceived long-standing limitations in usual activities due to health problems. The variables on unmet needs for health care focus on two broad categories of services: medical care and dental care. These variables capture whether respondents felt they needed a specific examination or treatment but did not receive it, along with the main reason for not obtaining the care. Eurostat currently disseminates the following indicators on unmet health care needs: self-reported unmet needs for medical examination due to barriers of access, self-reported unmet needs for medical examination by reason, and self-reported unmet needs for dental examination by reason. All indicators are expressed as percentages of the population, with breakdowns by sex, age, labour status, educational attainment level, and income quintile group. Data for individual countries are published starting in the fourth quarter of year N+1, where N is the year of data collection. EU aggregates and health indicators for all countries, provided the data is available, are typically released by the end of February N+2."),
    (8, "Government contingent liabilities and potential obligations (gov_cl)", "The data on contingent liabilities and potential obligations of government are collected in the context of the Enhanced Economic Governance package, known as the 'six-pack,' adopted in 2011. In particular, Council Directive 2011/85 on requirements for budgetary frameworks of the Member States, amended by Council Directive 2024/1265, requires Member States to publish relevant information on contingent liabilities with potentially significant impacts on public budgets. These include government guarantees, non-performing loans, and liabilities arising from the operation of public corporations, including their extent. Liabilities are termed 'contingent' because they are, by nature, only potential and not actual liabilities. They materialize as actual government liabilities only under specific conditions. Non-performing loans could imply a potential loss for the government if these loans are not repaid by the original debtor. This new data collection enhances transparency in EU public finances by providing a more comprehensive picture of the financial positions of EU Member States. It is important to note that contingent liabilities are not included in the general government (Maastricht) debt as defined in Council Regulation (EC) No 479/2009 of 25 May 2009 on the application of the Protocol on the excessive deficit procedure annexed to the Treaty establishing the European Community. Eurostat collects and publishes several indicators related to contingent liabilities. These include government guarantees, liabilities related to public-private partnerships recorded off the government's balance sheet, liabilities of government-controlled entities classified outside general government (public corporations), and non-performing loans (government assets). Regarding government-controlled entities, these refer to government-controlled units that are not classified within the general government sector but are directly or indirectly controlled by the government through other public units. If the government owns less than 50% of a corporation and does not exert control over it, the entity is not considered government-controlled. According to ESA 2010 paragraph 20.18, control over an entity is defined as the ability to determine the general policy or program of that entity. The criteria for establishing government control over corporations are outlined in ESA 2010 paragraph 2.38 and further detailed in paragraph 20.309. ESA 2010 paragraph 2.38 states that general government secures control over a corporation through special legislation, decree, or regulation that empowers the government to determine corporate policy. The key indicators used to assess whether a corporation is controlled by the government include government ownership of the majority of voting interests, government control of the board or governing body, government control over the appointment and removal of key personnel, government control over key committees within the entity, government possession of a golden share, special regulations, government as a dominant customer, and borrowing from the government. A single indicator may be sufficient to establish control, but in some cases, multiple indicators may collectively indicate government control over an entity."),
    (9, "House price index", "Eurostat house price index (HPI) captures price changes of all residential properties purchased by households, including flats, detached houses, and terraced houses, both new and existing, independently of their final use and their previous owners. Only market prices are considered, meaning that self-build dwellings are excluded. The land component is included. The MIP scoreboard indicator represents the year-on-year growth rate of the nominal house price index. Additionally, the indicator standardised house price-to-income ratio is part of the MIP auxiliary indicators set. In the MIP domain, annual and quarterly figures are also published on the following: The house price index in nominal terms includes the average rate of change, the average index, and the percentage change between the current quarter and three quarters prior (T/T-3). The house price index in deflated terms includes the average index and the rate of change. The deflated house price index, also known as the real house price index, is calculated as the ratio between the HPI and the national accounts deflator for private final consumption expenditure, which includes households and non-profit institutions serving households (NPISHs)."),
    (10, "Annual national accounts (nama10)", "National accounts are a coherent and consistent set of macroeconomic indicators, which provide an overall picture of the economic situation and are widely used for economic analysis and forecasting, policy design and policy making. Eurostat publishes annual and quarterly national accounts, annual and quarterly sector accounts as well as supply, use and input-output tables, which are each presented with associated metadata. Even though consistency checks are a major aspect of data validation, temporary (usually limited) inconsistencies between datasets may occur, mainly due to vintage effects. Annual national accounts are compiled in accordance with the European System of Accounts ESA 2010 as defined in Annex B of the Council Regulation (EU) No 549/2013 of the European Parliament and of the Council of 21 May 2013, amended by Council Regulation (EU) 2023/734 of 15 March 2023. The previous European System of Accounts, ESA95, was reviewed to bring national accounts in the European Union in line with the new economic environment, advances in methodological research and needs of users and the updated national accounts framework at the international level, the SNA 2008. The associated transmission programme is also updated, and data transmissions in accordance with ESA 2010 are compulsory from September 2014 onwards. Further information is presented on the Eurostat website. The domain consists of the following collections. Main GDP aggregates include main components from the output, expenditure and income side, expenditure breakdowns by durability and exports and imports by origin. The category 'nama_10_ma' refers to main GDP aggregates. 'nama_10_gdp' concerns GDP and main components including output, expenditure and income. 'nama_10_fcs' includes final consumption aggregates by durability, while 'nama_10_exi' covers exports and imports by Member States of the EU and third countries. Key auxiliary indicators include population and employment data, which are used to derive main GDP aggregates per capita as well as productivity and unit labour cost indicators. The category 'nama_10_aux' refers to auxiliary indicators, covering population, GDP per capita and productivity. 'nama_10_pe' includes population and employment. 'nama_10_pc' focuses on main GDP aggregates per capita, while 'nama_10_lp_ulc' deals with labour productivity and unit labour costs. Breakdowns of GDP aggregates and employment data by main industries and asset classes are included in the category 'nama_10_bbr', which refers to basic breakdowns of main GDP aggregates and employment by industry and by assets. 'nama_10_a10' includes gross value added and income by A10 industry breakdowns. 'nama_10_an6' covers gross fixed capital formation by AN_F6 asset type, while 'nama_10_a10_e' includes employment by A10 industry breakdowns. Breakdowns of main GDP aggregates by industry and consumption purpose are included in the category 'nama_10_dbr', which refers to detailed breakdowns of main GDP aggregates by industry and consumption purpose. 'nama_10_a64' includes National Accounts aggregates by industry up to NACE A64. 'nama_10_a64_p5' covers gross capital formation by industry up to NACE A64, while 'nama_10_a64_e' refers to National Accounts employment data by industry up to NACE A*64. 'nama_10_co3_p3' covers final consumption expenditure of households by consumption purpose at the COICOP 3-digit level. Breakdowns of non-financial assets by type, industry and sector are included in the category 'nama_10_nfa'. 'nama_10_nfa_st' refers to the cross-classification of fixed assets by industry and by asset in terms of stocks. 'nama_10_nfa_fl' covers the cross-classification of gross fixed capital formation by industry and by asset in terms of flows, while 'nama_10_nfa_bs' includes balance sheets for non-financial assets. Geographical entities covered are the European Union, the euro area, EU Member States, EFTA countries and Candidate Countries. Data from other countries, including the US, Japan and other countries, are received via the OECD and IMF and published in Eurobase in the naid_10 collection. Data sources include National Statistical Institutes.")
    ] 

insert_eurostat_query = """
    INSERT INTO eurostat (id, argomento, descrizione) 
    VALUES (:id, :argomento, :descrizione)
    ON CONFLICT (id) DO NOTHING;
"""      

struttura_eurostat = ["id", "argomento", "descrizione"]

db_operations.insert_data(INPUT_DB_HOST, INPUT_DB_NAME, INPUT_DB_USER, INPUT_DB_PASSWORD, INPUT_DB_PORT, insert_eurostat_query, dati_eurostat, struttura_eurostat)

df_eurostat = db_operations.read_data(INPUT_DB_HOST, INPUT_DB_NAME, INPUT_DB_USER, INPUT_DB_PASSWORD, INPUT_DB_PORT,
                             "SELECT * FROM eurostat;")
print(df_eurostat)

nlp = spacy.load("en_core_web_md")

sentences = df_eurostat["descrizione"]

def extract_keywords(text, n_grams):
    return [kw for kw, _ in yake.KeywordExtractor(lan="en", n=n_grams, top=5).extract_keywords(text)]

def keyword_similarity(kw1, kw2):
    best_pair = None
    max_sim = 0
    similarities = []
    
    for w1 in kw1:
        for w2 in kw2:
            sim = nlp(w1).similarity(nlp(w2))
            similarities.append(sim)
            if sim > max_sim:
                max_sim = sim
                best_pair = (w1, w2)
    
    avg_similarity = np.mean(similarities) if similarities else 0
    return avg_similarity, best_pair

keywords_list1 = [extract_keywords(sentence, 1) for sentence in sentences]
keywords_list2 = [extract_keywords(sentence, 2) for sentence in sentences]
keywords_list3 = [extract_keywords(sentence, 3) for sentence in sentences]

def df_similarity(keywords_list):
    similarity_data = []
    for i, kw1 in enumerate(keywords_list):
        for j, kw2 in enumerate(keywords_list):
            if i < j:
                avg_similarity, best_pair = keyword_similarity(kw1, kw2)
                similarity_data.append({
                    "frase_x": f"Frase {i+1}",
                    "frase_y": f"Frase {j+1}",
                    "similarity": avg_similarity,
                    "keywords_x": kw1,
                    "keywords_y": kw2,
                    "miglior_coppia": best_pair
                })

    df_similarity = pd.DataFrame(similarity_data)
    return df_similarity

df_similarity(keywords_list1).to_sql("keywords_similarity_1", con=db_operations.create_db_engine(OUTPUT_DB_HOST, 
                                                                                         OUTPUT_DB_NAME, 
                                                                                         OUTPUT_DB_USER, 
                                                                                         OUTPUT_DB_PASSWORD, 
                                                                                         OUTPUT_DB_PORT), 
                                     if_exists="replace", index=False)
df_similarity(keywords_list2).to_sql("keywords_similarity_2", con=db_operations.create_db_engine(OUTPUT_DB_HOST, 
                                                                                         OUTPUT_DB_NAME, 
                                                                                         OUTPUT_DB_USER, 
                                                                                         OUTPUT_DB_PASSWORD, 
                                                                                         OUTPUT_DB_PORT), 
                                     if_exists="replace", index=False)
df_similarity(keywords_list3).to_sql("keywords_similarity_3", con=db_operations.create_db_engine(OUTPUT_DB_HOST, 
                                                                                         OUTPUT_DB_NAME, 
                                                                                         OUTPUT_DB_USER, 
                                                                                         OUTPUT_DB_PASSWORD, 
                                                                                         OUTPUT_DB_PORT), 
                                     if_exists="replace", index=False)           